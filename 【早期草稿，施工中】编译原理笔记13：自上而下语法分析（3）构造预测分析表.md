# 编译原理笔记13：自上而下语法分析（3）构造预测分析表

### 构造预测分析表

预测分析表的作用，是为推导的进行指明方向——我们用当前下推栈栈顶和读写头所指向的符号的组合（也就是，当前的状态），去查询预测分析表，以确定推导的下一步该向着何种方向前进。

推导应该前进的方向，由 FIRST、FOLLOW 集合说明——这两个集合能够说明，我们可以通过怎样的方式来一步步向着终结符靠近。



1. 看待填行的行首非终结符 A
2. 找到左部是上面看到的这个非终结符 A 的产生式
3. 如果产生式是以非终结符 B 打头的序列 α ，那么找到 FIRST(B)，将 FIRST(B) 集合中每个元素所在列、非终结符 A 所在行确定的位置填写上序列 α
4. 如果产生式是以终结符 a 打头的序列 β ，那么直接去找终结符 a 所在列，并将 β 填入 A 行 a 列的位置中
5. 如果产生式是 ε，则找到 FOLLOW(A) ，将 FOLLOW(A) 集合中每个元素所在行列、非终结符 A 所在行确定的位置填写上 ε



根据产生式左部的非终结符确定本次要构造的分析表行，一个产生式对应分析表中的一行。根据 FIRST、FOLLOW 集合，将产生式右部填入分析表，以此确定每行的内容。



比如对于产生式 `L → E;L|ε`，我们需要把产生出来的右部 `E;L` 和 `ε` 填入到分析表中。

FIRST(L) 集合告诉我们：

- 如果此时栈顶是 `L` ，而读写头读到了 `id`，那么我们应该用 `E;L` 来进行展开，因为这样可以让推导过程向着【把栈顶元素变为`id` 】的方向前进。
- 如果此时栈顶是 `L` ，而读写头读到了 `num` ，那么我们应该用 `E;L` 来进行展开，因为这样可以让推导过程向着【把栈顶元素变为 `num`】的方向前进；
- 如果此时栈顶是 `L` ，而读写头读到了 `(` ，那么我们应该用 `E;L` 来进行展开，因为这样可以让推导过程向着【把栈顶元素变为 `(`】的方向前进；

FIRST(L) 集合告诉我们，从非终结符 L 出发来继续进行推导，则最终能够推导出哪些终结符。因为 FIRST 集合中都是终结符，且是通过该集合对应的左部一定能推导出来的第一个终结符——而这【第一个终结符】中的某一个，就是当前符号流中读写头所指向的那个【待匹配的终结符】。~~通过 FIRST 构造预测分析表，其实就是换了个方向运用上述的对应关系：已知待推导的非终结符和最终应匹配上的终结符，来确定应该将正确的右部~~ 这个思路还有待权衡

当产生式右部是 ε 时，根据该产生式左部的非终结符所对应的 FOLLOW 集合来确定这个 ε 该填到哪里